{"ID":"20241106173938-t4z4fy5","Spec":"1","Type":"NodeDocument","Properties":{"id":"20241106173938-t4z4fy5","title":"重新安装devops","type":"doc","updated":"20241111162638"},"Children":[{"ID":"20241106173952-gr5i8ov","Type":"NodeParagraph","Properties":{"id":"20241106173952-gr5i8ov","updated":"20241106173952"},"Children":[{"Type":"NodeText","Data":"在 KubeSphere 中，重新安装 DevOps 模块通常用于解决插件或配置问题，或恢复到默认配置。KubeSphere 允许通过删除并重新部署 DevOps 模块来完成重新安装。以下是具体步骤："}]},{"ID":"20241106173952-utqhry8","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20241106173952-utqhry8","updated":"20241108112113"},"Children":[{"Type":"NodeText","Data":"步骤 1：卸载 DevOps 模块"}]},{"ID":"20241106173952-4uzz3iw","Type":"NodeList","ListData":{"Typ":1},"Properties":{"id":"20241106173952-4uzz3iw","updated":"20241108112035"},"Children":[{"ID":"20241106173952-pymsyaq","Type":"NodeListItem","ListData":{"Typ":1,"Delimiter":46,"Marker":"MS4=","Num":1},"Properties":{"id":"20241106173952-pymsyaq","updated":"20241106173952"},"Children":[{"ID":"20241106173952-8glutl3","Type":"NodeParagraph","Properties":{"id":"20241106173952-8glutl3","updated":"20241106173952"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"登录 KubeSphere 管理控制台"},{"Type":"NodeText","Data":"。"}]}]},{"ID":"20241106173952-2u8w67t","Type":"NodeListItem","ListData":{"Typ":1,"Delimiter":46,"Marker":"Mi4=","Num":2},"Properties":{"id":"20241106173952-2u8w67t","updated":"20241106173952"},"Children":[{"ID":"20241106173952-li86nl5","Type":"NodeParagraph","Properties":{"id":"20241106173952-li86nl5","updated":"20241106173952"},"Children":[{"Type":"NodeText","Data":"进入 "},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"平台管理"},{"Type":"NodeText","Data":" "},{"Type":"NodeBackslash","Data":"span","Children":[{"Type":"NodeText","Data":"\u003e"}]},{"Type":"NodeText","Data":" "},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"集群管理"},{"Type":"NodeText","Data":"，选择集群。"}]}]},{"ID":"20241106173952-yi70nzt","Type":"NodeListItem","ListData":{"Typ":1,"Delimiter":46,"Marker":"My4=","Num":3},"Properties":{"id":"20241106173952-yi70nzt","updated":"20241106173952"},"Children":[{"ID":"20241106173952-crso6b6","Type":"NodeParagraph","Properties":{"id":"20241106173952-crso6b6","updated":"20241106173952"},"Children":[{"Type":"NodeText","Data":"在左侧栏中找到 "},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"应用管理"},{"Type":"NodeText","Data":" "},{"Type":"NodeBackslash","Data":"span","Children":[{"Type":"NodeText","Data":"\u003e"}]},{"Type":"NodeText","Data":" "},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"组件"},{"Type":"NodeText","Data":"。"}]}]},{"ID":"20241106173952-9h43jml","Type":"NodeListItem","ListData":{"Typ":1,"Delimiter":46,"Marker":"NC4=","Num":4},"Properties":{"id":"20241106173952-9h43jml","updated":"20241106173952"},"Children":[{"ID":"20241106173952-l12a4k2","Type":"NodeParagraph","Properties":{"id":"20241106173952-l12a4k2","updated":"20241106173952"},"Children":[{"Type":"NodeText","Data":"找到 "},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"KubeSphere DevOps 系统"},{"Type":"NodeText","Data":"，点击 "},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"禁用"},{"Type":"NodeText","Data":"，等待 DevOps 模块停止运行。"}]},{"ID":"20241106173952-ah9j5g2","Type":"NodeBlockquote","Properties":{"id":"20241106173952-ah9j5g2","updated":"20241106173952"},"Children":[{"Type":"NodeBlockquoteMarker","Data":"\u003e"},{"ID":"20241106173952-2ugfqgo","Type":"NodeParagraph","Properties":{"id":"20241106173952-2ugfqgo","updated":"20241106173952"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"注意"},{"Type":"NodeText","Data":"：禁用 DevOps 系统会中断所有现有的 DevOps 项目及流水线。"}]}]}]},{"ID":"20241106173952-boeqldb","Type":"NodeListItem","ListData":{"Typ":1,"Delimiter":46,"Marker":"NS4=","Num":5},"Properties":{"id":"20241106173952-boeqldb","updated":"20241108112035"},"Children":[{"ID":"20241106173952-aq8ysxq","Type":"NodeParagraph","Properties":{"id":"20241106173952-aq8ysxq","updated":"20241106173952"},"Children":[{"Type":"NodeText","Data":"也可以通过命令行方式卸载 DevOps 模块："}]},{"ID":"20241106173952-ys96v56","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20241106173952-ys96v56","updated":"20241108112035"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YmFzaA=="},{"Type":"NodeCodeBlockCode","Data":"############ DevOps Application Deletion ############\n# Uninstall DevOps application\nhelm uninstall -n kubesphere-devops-system devops\n# Remove DevOps installation status\nkubectl patch -nkubesphere-system cc ks-installer --type=json -p='[{\"op\": \"remove\", \"path\": \"/status/devops\"}]'\n# Disable DevOps application\nkubectl patch -nkubesphere-system cc ks-installer --type=json -p='[{\"op\": \"replace\", \"path\": \"/spec/devops/enabled\", \"value\": false}]'\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]}]}]},{"ID":"20241108112047-q16gj7i","Type":"NodeParagraph","Properties":{"id":"20241108112047-q16gj7i","updated":"20241108112047"}},{"ID":"20241108112052-2vbqzm7","Type":"NodeBlockquote","Properties":{"id":"20241108112052-2vbqzm7","updated":"20241108112113"},"Children":[{"ID":"20241108112100-74nyhu5","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20241108112100-74nyhu5","updated":"20241108112113"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"c2hlbGw="},{"Type":"NodeCodeBlockCode","Data":"‍```\n############# DevOps Resource Deletion ##############\n# Remove all resources related with DevOps\nfor devops_crd in $(kubectl get crd -o=jsonpath='{range .items[*]}{.metadata.name}{\"\\n\"}{end}' | grep \"devops.kubesphere.io\"); do\n    # Get all resource\n    for ns in $(kubectl get ns -ojsonpath='{.items..metadata.name}'); do\n        for devops_res in $(kubectl get $devops_crd -n $ns -oname); do\n            kubectl patch $devops_res -n $ns -p '{\"metadata\":{\"finalizers\":[]}}' --type=merge\n        done\n    done\ndone\n# Remove all DevOps CRDs\nkubectl get crd -o=jsonpath='{range .items[*]}{.metadata.name}{\"\\n\"}{end}' | grep \"devops.kubesphere.io\" | xargs -I crd_name kubectl delete crd crd_name\n# Remove unused namespaces\nkubectl delete namespace kubesphere-devops-system\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"Type":"NodeBlockquoteMarker","Data":"\u003e"},{"ID":"20241108112058-qqvur1j","Type":"NodeParagraph","Properties":{"id":"20241108112058-qqvur1j","updated":"20241108112059"},"Children":[{"Type":"NodeText","Data":" ```"}]}]},{"ID":"20241106175206-uttgmb3","Type":"NodeParagraph","Properties":{"id":"20241106175206-uttgmb3","updated":"20241106175206"},"Children":[{"Type":"NodeText","Data":"在 KubeSphere 中卸载 DevOps 模块后，可以通过重新启用 DevOps 功能来重新安装它。具体步骤如下："}]},{"ID":"20241108123715-evo77q6","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20241108123715-evo77q6","updated":"20241108123822"},"Children":[{"Type":"NodeText","Data":"在安装后启用 DevOps"}]},{"ID":"20241108123715-v51qpkb","Type":"NodeList","ListData":{"Typ":1},"Properties":{"id":"20241108123715-v51qpkb","updated":"20241108123822"},"Children":[{"ID":"20241108123715-jxcnu4e","Type":"NodeListItem","ListData":{"Typ":1,"Delimiter":46,"Marker":"MS4=","Num":1},"Properties":{"id":"20241108123715-jxcnu4e","updated":"20241108123715"},"Children":[{"ID":"20241108123715-s3ihjgs","Type":"NodeParagraph","Properties":{"id":"20241108123715-s3ihjgs","updated":"20241108123715"},"Children":[{"Type":"NodeText","Data":"以 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"admin"},{"Type":"NodeText","Data":"​ 用户登录控制台，点击左上角的"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"平台管理"},{"Type":"NodeText","Data":"，选择"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"集群管理"},{"Type":"NodeText","Data":"。"}]}]},{"ID":"20241108123715-tr8pj27","Type":"NodeListItem","ListData":{"Typ":1,"Delimiter":46,"Marker":"Mi4=","Num":2},"Properties":{"id":"20241108123715-tr8pj27","updated":"20241108123822"},"Children":[{"ID":"20241108123715-dyu6y4r","Type":"NodeParagraph","Properties":{"id":"20241108123715-dyu6y4r","updated":"20241108123715"},"Children":[{"Type":"NodeText","Data":"点击"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"定制资源定义"},{"Type":"NodeText","Data":"，在搜索栏中输入 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"clusterconfiguration"},{"Type":"NodeText","Data":"​，点击搜索结果查看其详细页面。\n信息\n定制资源定义（CRD）允许用户在不新增 API 服务器的情况下创建一种新的资源类型，用户可以像使用其他 Kubernetes 原生对象一样使用这些定制资源。"}]},{"ID":"20241108123715-cfcwn8t","Type":"NodeList","ListData":{"Typ":1},"Properties":{"id":"20241108123715-cfcwn8t","updated":"20241108123822"},"Children":[{"ID":"20241108123715-vzi7tkg","Type":"NodeListItem","ListData":{"Typ":1,"Delimiter":46,"Marker":"MS4=","Num":1},"Properties":{"id":"20241108123715-vzi7tkg","updated":"20241108123715"},"Children":[{"ID":"20241108123715-w4gedz8","Type":"NodeParagraph","Properties":{"id":"20241108123715-w4gedz8","updated":"20241108123715"},"Children":[{"Type":"NodeText","Data":"在"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"自定义资源"},{"Type":"NodeText","Data":"中，点击 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"ks-installer"},{"Type":"NodeText","Data":"​ 右侧的 "},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"https://kubesphere.io/images/docs/v3.x/zh-cn/enable-pluggable-components/kubesphere-devops-system/three-dots.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"，选择"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"编辑 YAML"},{"Type":"NodeText","Data":"。"}]}]},{"ID":"20241108123715-511e2ho","Type":"NodeListItem","ListData":{"Typ":1,"Delimiter":46,"Marker":"Mi4=","Num":2},"Properties":{"id":"20241108123715-511e2ho","updated":"20241108123715"},"Children":[{"ID":"20241108123715-8qdwgqn","Type":"NodeParagraph","Properties":{"id":"20241108123715-8qdwgqn","updated":"20241108123715"},"Children":[{"Type":"NodeText","Data":"在该 YAML 文件中，搜索 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"devops"},{"Type":"NodeText","Data":"​，将 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"enabled"},{"Type":"NodeText","Data":"​ 的 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"false"},{"Type":"NodeText","Data":"​ 改为 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"true"},{"Type":"NodeText","Data":"​。完成后，点击右下角的"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"确定"},{"Type":"NodeText","Data":"，保存配置。"}]},{"ID":"20241108123715-xsgv80d","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20241108123715-xsgv80d","updated":"20241108123715"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"eWFtbA=="},{"Type":"NodeCodeBlockCode","Data":"devops:\n  enabled: true # 将“false”更改为“true”。\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]}]},{"ID":"20241108123715-jqazqje","Type":"NodeListItem","ListData":{"Typ":1,"Delimiter":46,"Marker":"My4=","Num":3},"Properties":{"id":"20241108123715-jqazqje","updated":"20241108123822"},"Children":[{"ID":"20241108123715-oq8aolj","Type":"NodeParagraph","Properties":{"id":"20241108123715-oq8aolj","updated":"20241108123715"},"Children":[{"Type":"NodeText","Data":"在 kubectl 中执行以下命令检查安装过程："}]},{"ID":"20241108123715-k99hvae","Type":"NodeBlockquote","Properties":{"id":"20241108123715-k99hvae","updated":"20241108123822"},"Children":[{"Type":"NodeBlockquoteMarker","Data":"\u003e"},{"ID":"20241108123804-2u293kw","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20241108123804-2u293kw","updated":"20241108123822"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"c2hlbGw="},{"Type":"NodeCodeBlockCode","Data":"kubectl logs -n kubesphere-system $(kubectl get pod -n kubesphere-system -l 'app in (ks-install, ks-installer)' -o jsonpath='{.items[0].metadata.name}') -f\n\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]}]}]}]}]}]},{"ID":"20241108123801-hdv8s8x","Type":"NodeParagraph","Properties":{"id":"20241108123801-hdv8s8x","updated":"20241108123801"}}]}